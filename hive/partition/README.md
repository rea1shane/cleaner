# Hive Table Partition Cleaner

清理指定 Hive 表中不符合指定策略的分区数据。

## 清理策略

通过策略，策略的最小单元为规则，多个规则组合为模式。

### 规则

用于判断分区是否需要保留的规则，符合规则的将被保留。

`rule 1`：日期距当前日期小于等于 31 天。

`rule 2`：日期距当前日期小于等于 365 天。

`rule 3`：日期是所属月的最后一天。

`rule 4`：所属月没有最后一天的分区。

`rule 5`：分区是该表的最新分区。

`rule 6`：日期距当前日期小于等于 10 天。

`rule 7`：分区为所属月最后一个分区。

`rule 8`：分区为该表的最新的 31 个分区之一。

### 模式

每种模式中至少包含一条规则，符合其中任何一条规则的分区将被保留，全部规则都不符合的分区将被删除。

| 模式      | 包含的规则                                  |
|---------|----------------------------------------|
| `mod 1` | `rule 1`, `rule 3`, `rule 4`, `rule 5` |
| `mod 2` | `rule 2`, `rule 3`, `rule 4`, `rule 5` |
| `mod 3` | `rule 3`, `rule 6`                     |
| `mod 4` | `rule 7`                               |
| `mod 5` | `rule 7`, `rule 8`                     |

## 清理方式

删除指定 Hive 表的指定分区在存储系统上的文件目录。

目前支持清理的 Hive 底层存储系统有：

- HDFS
